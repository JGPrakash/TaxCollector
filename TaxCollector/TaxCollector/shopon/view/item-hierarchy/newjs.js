$.fn.itemHierarchyPage=function (){return $.pageController.getPage(this, function (page, $$, e){page.itemHieAPI=new ItemHierarchyAPI(); page.itemAttrCacheAPI=new ItemAttrCacheAPI(); page.itemCategoryAPI=new ItemCategoryAPI(); page.itemAttributeAPI=new ItemAttributeAPI(); $("body").keydown(function (e){var keyCode=e.keyCode || e.which;}); page.events={page_load: function (){page.loadItemHierarchy(); $$("ddlType").selectionChange(function (){page.loadItemHierarchy();})}, btnSearch_click : function(){page.loadItemHierarchy();}, grditemHierarchy_select: function (row,item){$(".basic-info").show(); page.loadAttrCache(item.type,item.t_no);}}page.loadCategory=function (){var filter=""; var data={start_record: 0, end_record: "", filter_expression: filter, sort_expression: " cat_no,cat_name "}page.itemCategoryAPI.searchValue(data.start_record, data.end_record, data.filter_expression, data.sort_expression, function (data){$$("ddlCategory").dataBind(data, "cat_no", "cat_name");})}page.loadAttrCache=function (type,mpt_no,ptype_no,item_no){var filter=""; if(type="MPT") filter=" (type,item_no) in ( ('MPT'," + mpt_no + ") )"; else if (type="MPT") filter=" (type,item_no) in ( ('MPT'," + mpt_no + ") ) ,('PT'," + ptype_no + "))"; else filter=" (type,item_no) in ( ('MPT'," + mpt_no + ") ,('PT'," + ptype_no + "),('Item'," + item_no + ")) "; var data={start_record: 0, end_record: "", filter_expression: filter, sort_expression: " cat_no,cat_name "}page.itemAttrCacheAPI.searchValue(data.start_record, data.end_record, data.filter_expression, data.sort_expression, function (data){page.loadGridItemCategory(data);})}page.loadItemHierarchy=function (){var filter=""; filter=" concat(ifnull(type,''),ifnull(name,'')) like '%" + $$("txtSearch").value() + "%'"; if ($$("ddlType").selectedValue() !="All"){filter=filter + " and type='" + $$("ddlType").selectedValue()+"'";}var data={start_record: 0, end_record: "", filter_expression: filter, sort_expression: " type,t_no "}page.itemHieAPI.searchValue(data.start_record, data.end_record, data.filter_expression, data.sort_expression, function (data){page.loadGridItemHierarchy(data);})}page.loadGridItemCategory=function (data){page.controls.grditemCategory.width("100%"); page.controls.grditemCategory.height("330px"); page.controls.grditemCategory.setTemplate({selection: "Single", paging: true, pageSize: 50, columns: [{'name': "C No", 'width': "150px", 'dataField': "cat_no"},{'name': "Category", 'width': "150px", 'dataField': "cat_name"},]}); page.controls.grditemCategory.rowBound=function (row, item){row.css("cursor", "pointer"); row.click(function (){row.parent().children("div").css("background-color", "");});}page.controls.grditemCategory.dataBind(data);}page.loadGridItemHierarchy=function (data){page.controls.grditemHierarchy.width("100%"); page.controls.grditemHierarchy.height("530px"); page.controls.grditemHierarchy.setTemplate({selection: "Single", paging: true, pageSize: 50, columns: [{'name': "No", 'width': "60px", 'dataField': "t_no"},{'name': "Type", 'width': "80px", 'dataField': "type"},{'name': "Name", 'width': "150px", 'dataField': "name"},{'name': "MPT No", 'width': "60px", 'dataField': "mpt_no"},{'name': "Item No", 'width': "60px", 'dataField': "item_no"},{'name': "PT No", 'width': "60px", 'dataField': "ptype_no"},]}); page.controls.grditemHierarchy.rowBound=function (row, item){row.css("cursor", "pointer"); row.click(function (){row.parent().children("div").css("background-color", "");});}page.controls.grditemHierarchy.selectionChanged=page.events.grditemHierarchy_select; page.controls.grditemHierarchy.dataBind(data);}});}